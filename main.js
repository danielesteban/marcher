!function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function r(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function a(e){let t;return s(e,(e=>t=e))(),t}function c(e,t,n){e.$$.on_destroy.push(s(t,n))}function l(e,t,n,o){if(e){const r=u(e,t,n,o);return e[0](r)}}function u(e,t,n,o){return e[1]&&o?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](o(t))):n.ctx}function f(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}function d(e,t,n,o,r,i){if(r){const s=u(t,n,o,i);e.p(s,r)}}function p(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function h(e,t,n){return e.set(n),t}function v(e,t){e.appendChild(t)}function m(e,t,n){e.insertBefore(t,n||null)}function g(e){e.parentNode.removeChild(e)}function x(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function b(e){return document.createElement(e)}function y(e){return document.createTextNode(e)}function $(){return y(" ")}function w(){return y("")}function S(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function k(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function F(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function M(e,t,n,o){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function L(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}e.selectedIndex=-1}function z(e,t,n){e.classList[n?"add":"remove"](t)}let D;function P(e){D=e}function E(){if(!D)throw new Error("Function called outside component initialization");return D}function _(e){E().$$.on_mount.push(e)}const q=[],C=[],T=[],j=[],B=Promise.resolve();let R=!1;function U(){R||(R=!0,B.then(G))}function I(){return U(),B}function A(e){T.push(e)}const N=new Set;let O=0;function G(){const e=D;do{for(;O<q.length;){const e=q[O];O++,P(e),V(e.$$)}for(P(null),q.length=0,O=0;C.length;)C.pop()();for(let e=0;e<T.length;e+=1){const t=T[e];N.has(t)||(N.add(t),t())}T.length=0}while(q.length);for(;j.length;)j.pop()();R=!1,N.clear(),P(e)}function V(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(A)}}const W=new Set;let Y;function H(){Y={r:0,c:[],p:Y}}function X(){Y.r||o(Y.c),Y=Y.p}function K(e,t){e&&e.i&&(W.delete(e),e.i(t))}function J(e,t,n,o){if(e&&e.o){if(W.has(e))return;W.add(e),Y.c.push((()=>{W.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}else o&&o()}const Z="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Q(e){e&&e.c()}function ee(e,n,i,s){const{fragment:a,on_mount:c,on_destroy:l,after_update:u}=e.$$;a&&a.m(n,i),s||A((()=>{const n=c.map(t).filter(r);l?l.push(...n):o(n),e.$$.on_mount=[]})),u.forEach(A)}function te(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ne(t,r,i,s,a,c,l,u=[-1]){const f=D;P(t);const d=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(f?f.$$.context:[])),callbacks:n(),dirty:u,skip_bound:!1,root:r.target||f.$$.root};l&&l(d.root);let p=!1;if(d.ctx=i?i(t,r.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=r)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](r),p&&function(e,t){-1===e.$$.dirty[0]&&(q.push(e),U(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],d.update(),p=!0,o(d.before_update),d.fragment=!!s&&s(d.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);d.fragment&&d.fragment.l(e),e.forEach(g)}else d.fragment&&d.fragment.c();r.intro&&K(t.$$.fragment),ee(t,r.target,r.anchor,r.customElement),G()}P(f)}class oe{$destroy(){te(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const re=[];function ie(t,n=e){let o;const r=new Set;function s(e){if(i(t,e)&&(t=e,o)){const e=!re.length;for(const e of r)e[1](),re.push(e,t);if(e){for(let e=0;e<re.length;e+=2)re[e][0](re[e+1]);re.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(i,a=e){const c=[i,a];return r.add(c),1===r.size&&(o=n(s)||e),i(t),()=>{r.delete(c),0===r.size&&(o(),o=null)}}}}const se=(e,t)=>{e=`marcher:${e}`;const n=localStorage.getItem(e),{subscribe:o,set:r}=ie(n?JSON.parse(n):t);return{subscribe:o,set:t=>{r(t),localStorage.setItem(e,JSON.stringify(t))}}},ae=["const background : vec3<f32> = vec3<f32>(0, 0, 0);\nconst fogDensity : f32 = 0.005;\n\nfn getEffect(pixel : vec2<i32>) -> vec3<f32> {\n  let data : vec4<f32> = textureLoad(dataTexture, pixel, 0);\n  let depth : f32 = data.w;\n  if (depth >= camera.far) {\n    return background;\n  }\n  let color : vec4<f32> = textureLoad(colorTexture, pixel, 0);\n  let position : vec3<f32> = textureLoad(positionTexture, pixel, 0).xyz;\n  var out : vec3<f32> = color.xyz * getLight(data.xyz, position);\n  out = mix(out, background, 1 - exp(-fogDensity * fogDensity * depth * depth) * color.w);\n  return out;\n}\n\nfn getLight(normal : vec3<f32>, position : vec3<f32>) -> vec3<f32> {\n  return (\n    0.1\n    + getDirectLight(Light(position + vec3<f32>(0, 1, 0), vec3<f32>(1), vec3<f32>(0.3)), normal, position, 32) * 0.5\n    + getDirectLight(Light(position + vec3<f32>(1, 1, 1), vec3<f32>(1), vec3<f32>(0.3)), normal, position, 32) * 0.25\n    + getDirectLight(Light(position + vec3<f32>(-1, 1, -1), vec3<f32>(1), vec3<f32>(0.3)), normal, position, 32) * 0.25\n  );\n}\n","const background : vec3<f32> = vec3<f32>(0, 0, 0);\nconst fogDensity : f32 = 0.005;\n\nconst edgeColor : vec3<f32> = vec3<f32>(0, 0, 0);\nconst edgeIntensity : f32 = 0.5;\nconst depthScale : f32 = 0.5;\nconst depthBias : f32 = 1;\nconst normalBias : f32 = 10;\nconst normalScale : f32 = 0.5;\n\nfn getEffect(pixel : vec2<i32>) -> vec3<f32> {\n  let data : vec4<f32> = textureLoad(dataTexture, pixel, 0);\n  let depth : f32 = data.w;\n  if (depth >= camera.far) {\n    return background;\n  }\n  let color : vec4<f32> = textureLoad(colorTexture, pixel, 0);\n  let position : vec3<f32> = textureLoad(positionTexture, pixel, 0).xyz;\n  var out : vec3<f32> = color.xyz * getLight(data.xyz, position);\n  out = mix(out, edgeColor, getEdge(pixel, data) * edgeIntensity);\n  out = mix(out, background, 1 - exp(-fogDensity * fogDensity * depth * depth) * color.w);\n  return out;\n}\n\nfn getLight(normal : vec3<f32>, position : vec3<f32>) -> vec3<f32> {\n  return (\n    0.1\n    + getDirectLight(Light(position + vec3<f32>(0, 1, 0), vec3<f32>(1), vec3<f32>(0.3)), normal, position, 32) * 0.5\n    + getDirectLight(Light(position + vec3<f32>(1, 1, 1), vec3<f32>(1), vec3<f32>(0.3)), normal, position, 32) * 0.25\n    + getDirectLight(Light(position + vec3<f32>(-1, 1, -1), vec3<f32>(1), vec3<f32>(0.3)), normal, position, 32) * 0.25\n  );\n}\n\nfn getEdge(pixel : vec2<i32>, data : vec4<f32>) -> f32 {\n  const offset : vec3<i32> = vec3<i32>(1, 1, 0);\n  let dataLeft : vec4<f32> = textureLoad(dataTexture, pixel - offset.xz, 0);\n  let dataRight : vec4<f32> = textureLoad(dataTexture, pixel + offset.xz, 0);\n  let dataUp : vec4<f32> = textureLoad(dataTexture, pixel + offset.zy, 0);\n  let dataDown : vec4<f32> = textureLoad(dataTexture, pixel - offset.zy, 0);\n  let edge : vec4<f32> = (\n    abs(dataLeft - data)\n    + abs(dataRight - data) \n    + abs(dataUp - data) \n    + abs(dataDown - data)\n  );\n  return clamp(max(pow((edge.x + edge.y + edge.z) * normalScale, normalBias), pow(edge.w * depthScale, depthBias)), 0, 1);\n}\n","const background : vec3<f32> = vec3<f32>(0, 0, 0);\nconst fogDensity : f32 = 0.005;\n\nfn getEffect(pixel : vec2<i32>) -> vec3<f32> {\n  let data : vec4<f32> = textureLoad(dataTexture, pixel, 0);\n  let depth : f32 = data.w;\n  if (depth >= camera.far) {\n    return background;\n  }\n  let color : vec4<f32> = textureLoad(colorTexture, pixel, 0);\n  let position : vec3<f32> = textureLoad(positionTexture, pixel, 0).xyz;\n  var out : vec3<f32> = color.xyz * getLight(data.xyz, position);\n  out = mix(out, background, 1 - exp(-fogDensity * fogDensity * depth * depth) * color.w);\n  return out;\n}\n\nfn getLight(normal : vec3<f32>, position : vec3<f32>) -> vec3<f32> {\n  let light : Light = Light(\n    camera.position,\n    vec3<f32>(1, 1, 1),\n    vec3<f32>(0.3)\n  );\n  let theta = dot(camera.direction, -normalize(light.position - position));\n  return (\n    (\n      getDirectLight(light, normal, position, 128)\n      * getAttenuation(distance(light.position, position), 1, 0.007, 0.0002)\n      * clamp((theta - PI * 0.2) / (PI * 0.5), 0, 1)\n    )\n  );\n}\n","const background : vec3<f32> = vec3<f32>(0, 0, 0);\n\nfn getEffect(pixel : vec2<i32>) -> vec3<f32> {\n  let data : vec4<f32> = textureLoad(dataTexture, pixel, 0);\n  let depth : f32 = data.w;\n  if (depth >= camera.far) {\n    return background;\n  }\n  let color : vec4<f32> = textureLoad(colorTexture, pixel, 0);\n  let position : vec3<f32> = textureLoad(positionTexture, pixel, 0).xyz;\n  var out : vec3<f32> = color.xyz * getLight(data.xyz, position);\n  out = mix(out, background, 1 - color.w);\n  return out;\n}\n\nfn getLight(normal : vec3<f32>, position : vec3<f32>) -> vec3<f32> {\n  const target : vec3<f32> = vec3<f32>(0, 0, -8);\n  let lights : array<Light, 2> = array<Light, 2>(\n    Light(\n      target + spherical(PI * 0.25, time, 8),\n      vec3<f32>(0.8, 0.4, 0),\n      vec3<f32>(0.3)\n    ),\n    Light(\n      target + spherical(PI * 0.25, time - PI, 8),\n      vec3<f32>(0, 0.2, 0.8),\n      vec3<f32>(0.3)\n    ),\n  );\n  var light : vec3<f32> = vec3<f32>(0.01);\n  for (var i : u32 = 0; i < 2; i++) {\n    light += (\n      getDirectLight(lights[i], normal, position, 32)\n      * getAttenuation(distance(lights[i].position, position), 1, 0.09, 0.032)\n    );\n  }\n  return light;\n}\n"],ce={editor:null,errors:ie([]),source:se("effect",ae[0])},le=["fn getScene(pos : vec3<f32>) -> SDF {\n  let q : vec3<f32> = pos - vec3<f32>(0, 0, -8);\n  let d : f32 = sin(q.x * 10) * sin(q.y * 10) * sin(q.z * 10) * 0.1;\n  return SDF(\n    vec3<f32>(1, 1, 1) - vec3<f32>(d * 10, d * 5, d * 5),\n    sdSphere(q, 4) + d\n  );\n}\n","fn getScene(pos : vec3<f32>) -> SDF {\n  let q : vec3<f32> = pos - vec3<f32>(0, 0, -8);\n  let d : f32 = sin(q.x * 10) * sin(q.y * 10) * sin(q.z * 10) * 0.1;\n\n  let a : SDF = SDF(\n    vec3<f32>(1, 1, 1) - vec3<f32>(d * 10, d * 5, d * 5),\n    sdSphere(q, 4) + d\n  );\n\n  let b : SDF = SDF(\n    clamp(vec3<f32>(0.5, 0.5, 0.5) + vec3<f32>(d * 10, d * 5, d * 5), vec3<f32>(0), vec3<f32>(1)),\n    sdSphere(q - vec3<f32>(0, 0, 4), 2) + d\n  );\n\n  return opSmoothSubstraction(a, b, 0.15);\n}\n","fn getScene(pos : vec3<f32>) -> SDF {\n  var scene : SDF = SDF(\n    vec3<f32>(.8, .1, .05),\n    sdBox(rotateY(PI * 0.25) * rotateX(PI * 0.25) * (pos - vec3<f32>(-7, 0, -10)), vec3<f32>(1, 1, 1))\n  );\n  scene = opUnion(scene, SDF(\n    vec3<f32>(.8, .2, .05),\n    sdCapsule(pos - vec3<f32>(-3.5, 0, -10), vec2<f32>(0.5, 2))\n  ));\n  scene = opUnion(scene, SDF(\n    vec3<f32>(.2, .2, .8),\n    sdSphere(pos - vec3<f32>(0, 0, -10), 1)\n  ));\n  scene = opUnion(scene, SDF(\n    vec3<f32>(.8, .2, .05),\n    sdEllipsoid(pos - vec3<f32>(3.5, 0, -10), vec3<f32>(1, 2, 1))\n  ));\n  scene = opUnion(scene, SDF(\n    vec3<f32>(.8, .1, .05),\n    sdTorus(rotateX(PI * 0.5) * (pos - vec3<f32>(7, 0, -10)), vec2<f32>(1, 0.25))\n  ));\n  scene = opSmoothUnion(scene, SDF(\n    vec3<f32>(0.8, 0.8, 0.1),\n    sdPlane(pos, vec3<f32>(0, 1, 0), 1.5)\n  ), 1);\n  return scene;\n}\n","fn getScene(pos : vec3<f32>) -> SDF {\n  const r : vec3<f32> = vec3<f32>(8, 8, 8);\n  let q = abs(pos % r) - r * 0.5;\n\n  let id : vec3<f32> = floor(pos / r);\n  let n = SimplexNoise(id);\n  let s = 1 + sin(id.x * id.y * id.z);\n  let di = 2 + (abs(id.x + id.y + id.z) % 8);\n  let d = sin(pos.x * di) * sin(pos.y * di) * sin(pos.z * di) * 0.1;\n\n  let a = SDF(\n    getColor(u32(abs(n + 0.5) * 0xFFFFFF)),\n    sdSphere(q + sin(id + time * 0.5) * (s * 0.5), s) + d\n  );\n  let b = SDF(\n    getColor(u32(abs(n - 0.5) * 0xFFFFFF)),\n    sdSphere(q - sin(id + time * sin(id.x + id.z) * 0.5) * (s * 0.5), s) - d\n  );\n  return opSmoothUnion(a, b, 1);\n}\n\nfn getColor(c : u32) -> vec3<f32> {\n  return vec3<f32>(\n    f32((c >> 16) & 0xFF) / 0xFF,\n    f32((c >> 8) & 0xFF) / 0xFF,\n    f32(c & 0xFF) / 0xFF,\n  );\n}\n","fn getScene(pos : vec3<f32>) -> SDF {\n  let q = pos - vec3<f32>(0, 0, -64);\n  let n = abs(FBM(q * (0.06 + sin(time * 0.5) * 0.01) - 0.2));\n  return SDF(\n    hsl2Rgb(vec3<f32>(n, 0.7, 0.5)),\n    sdSphere(q, 32 - n * 8)\n  );\n}\n\nfn FBM(p : vec3<f32>) -> f32 {\n  var value : f32;\n  var amplitude : f32 = 0.5;\n  var q : vec3<f32> = p;\n  for (var i : i32 = 0; i < 3; i++) {\n    value += SimplexNoise(q) * amplitude;\n    q *= 2;\n    amplitude *= 0.5;\n  }\n  return value;\n}\n"],ue={editor:null,errors:ie([]),source:se("scene",le[0])},fe=ie(!1),de={gpu:null,input:null,iterations:se("iterations",300),mode:se("mode","raymarching"),resolution:se("resolution",1)},pe=ie("scene"),he=()=>{const e=new Blob([JSON.stringify({effect:a(ce.source),scene:a(ue.source),iterations:a(de.iterations),mode:a(de.mode),resolution:a(de.resolution),version:1})],{type:"application/json"}),t=new Date,n=e=>("00"+e).slice(-2);return{path:`marcher-${`${n(t.getMonth()+1)}${n(t.getDate())}`}${`${n(t.getHours())}${n(t.getMinutes())}`}.json`,content:e}};function ve(e,t,n){const o=e.slice();return o[11]=t[n].lineNum,o[12]=t[n].linePos,o[13]=t[n].type,o[14]=t[n].message,o[15]=t[n].line,o[16]=t[n].pointer,o}function me(e){let t,n,o,r,i,s,a,c,l,u,f,d,p,h,x,w,S,M=e[11]+"",L=e[12]+"",z=e[13]+"",D=e[14]+"",P=e[15]+"",E=e[16]+"";return{c(){t=b("div"),n=b("div"),o=y(":"),r=y(M),i=y(":"),s=y(L),a=$(),c=y(z),l=y(": "),u=y(D),f=$(),d=b("div"),p=y(P),h=$(),x=b("div"),w=y(E),S=$(),k(n,"class","svelte-1s5oj1u"),k(d,"class","svelte-1s5oj1u"),k(x,"class","svelte-1s5oj1u"),k(t,"class","svelte-1s5oj1u")},m(e,g){m(e,t,g),v(t,n),v(n,o),v(n,r),v(n,i),v(n,s),v(n,a),v(n,c),v(n,l),v(n,u),v(t,f),v(t,d),v(d,p),v(t,h),v(t,x),v(x,w),v(t,S)},p(e,t){4&t&&M!==(M=e[11]+"")&&F(r,M),4&t&&L!==(L=e[12]+"")&&F(s,L),4&t&&z!==(z=e[13]+"")&&F(c,z),4&t&&D!==(D=e[14]+"")&&F(u,D),4&t&&P!==(P=e[15]+"")&&F(p,P),4&t&&E!==(E=e[16]+"")&&F(w,E)},d(e){e&&g(t)}}}function ge(t){let n,o,r,i,s,a,c,l,u,f,d,p,h,w,M=t[2].length+"",L=t[2],D=[];for(let e=0;e<L.length;e+=1)D[e]=me(ve(t,L,e));return{c(){n=b("div"),o=b("div"),r=$(),i=b("div"),s=b("div"),a=b("div"),c=$(),l=y(M),u=y(" errors\n      "),f=b("div"),d=$(),p=b("div");for(let e=0;e<D.length;e+=1)D[e].c();k(o,"class","wrapper svelte-1s5oj1u"),k(a,"class","status svelte-1s5oj1u"),z(a,"error",t[2].length),k(f,"class","arrow svelte-1s5oj1u"),k(s,"class","toggle svelte-1s5oj1u"),k(p,"class","messages svelte-1s5oj1u"),k(i,"class","errors svelte-1s5oj1u"),z(i,"open",t[1]),k(n,"class","editor svelte-1s5oj1u")},m(e,g){m(e,n,g),v(n,o),t[7](o),v(n,r),v(n,i),v(i,s),v(s,a),v(s,c),v(s,l),v(s,u),v(s,f),v(i,d),v(i,p);for(let e=0;e<D.length;e+=1)D[e].m(p,null);h||(w=S(s,"click",t[5]),h=!0)},p(e,[t]){if(4&t&&z(a,"error",e[2].length),4&t&&M!==(M=e[2].length+"")&&F(l,M),4&t){let n;for(L=e[2],n=0;n<L.length;n+=1){const o=ve(e,L,n);D[n]?D[n].p(o,t):(D[n]=me(o),D[n].c(),D[n].m(p,null))}for(;n<D.length;n+=1)D[n].d(1);D.length=L.length}2&t&&z(i,"open",e[1])},i:e,o:e,d(e){e&&g(n),t[7](null),x(D,e),h=!1,w()}}}function xe(e,t,n){let o,r,{state:i}=t;const{errors:s,source:a}=i;let l,u;c(e,s,(e=>n(2,r=e))),c(e,a,(e=>n(9,o=e)));let f=!1;const d=()=>u.layout();return _((()=>{let e,t=!0,r=!1;if(u=monaco.editor.create(l,{minimap:{enabled:!1},theme:"vs-dark"}),i.editor){const{model:e,view:t}=i.editor;u.setModel(e),u.restoreViewState(t)}else u.setModel(monaco.editor.createModel(o,"c"));const c=[s.subscribe((e=>{monaco.editor.setModelMarkers(u.getModel(),"Errors",e.map((({lineNum:e,linePos:t,length:n,message:o})=>({message:o,startLineNumber:e,endLineNumber:e,startColumn:t,endColumn:t+n}))))})),a.subscribe((e=>{t||(r=!0,u.setValue(e),r=!1)}))];return t=!1,u.onDidChangeModelContent((()=>{r||(e&&clearTimeout(e),e=setTimeout((()=>{t=!0,a.set(u.getValue()),t=!1}),300))})),u.focus(),window.addEventListener("resize",d,!1),()=>{n(6,i.editor={model:u.getModel(),view:u.saveViewState()},i),u.dispose(),clearTimeout(e),window.removeEventListener("resize",d),c.forEach((e=>e()))}})),e.$$set=e=>{"state"in e&&n(6,i=e.state)},[l,f,r,s,a,()=>{n(1,f=!f),I().then(d)},i,function(e){C[e?"unshift":"push"]((()=>{l=e,n(0,l)}))}]}class be extends oe{constructor(e){super(),ne(this,e,xe,ge,i,{state:6})}}function ye(t){let n,o;return n=new be({props:{state:ce}}),{c(){Q(n.$$.fragment)},m(e,t){ee(n,e,t),o=!0},p:e,i(e){o||(K(n.$$.fragment,e),o=!0)},o(e){J(n.$$.fragment,e),o=!1},d(e){te(n,e)}}}class $e extends oe{constructor(e){super(),ne(this,e,null,ye,i,{})}}function we(e){let t;const n=e[4].default,o=l(n,e,e[3],null);return{c(){o&&o.c()},m(e,n){o&&o.m(e,n),t=!0},p(e,r){o&&o.p&&(!t||8&r)&&d(o,n,e,e[3],t?f(n,e[3],r,null):p(e[3]),null)},i(e){t||(K(o,e),t=!0)},o(e){J(o,e),t=!1},d(e){o&&o.d(e)}}}function Se(t){let n;return{c(){n=y("Copied!")},m(e,t){m(e,n,t)},p:e,i:e,o:e,d(e){e&&g(n)}}}function ke(e){let t,n,o,r,i,s;const a=[Se,we],c=[];function l(e,t){return e[0]?0:1}return n=l(e),o=c[n]=a[n](e),{c(){t=b("button"),o.c(),k(t,"class","svelte-1ngxztk")},m(o,a){m(o,t,a),c[n].m(t,null),r=!0,i||(s=S(t,"click",e[1]),i=!0)},p(e,[r]){let i=n;n=l(e),n===i?c[n].p(e,r):(H(),J(c[i],1,1,(()=>{c[i]=null})),X(),o=c[n],o?o.p(e,r):(o=c[n]=a[n](e),o.c()),K(o,1),o.m(t,null))},i(e){r||(K(o),r=!0)},o(e){J(o),r=!1},d(e){e&&g(t),c[n].d(),i=!1,s()}}}function Fe(e,t,n){let{$$slots:o={},$$scope:r}=t,{text:i}=t,s=!1,a=null;return e.$$set=e=>{"text"in e&&n(2,i=e.text),"$$scope"in e&&n(3,r=e.$$scope)},[s,()=>{navigator.clipboard.writeText(i),n(0,s=!0),clearTimeout(a),a=setTimeout((()=>I().then((()=>{n(0,s=!1)}))),1e3)},i,r,o]}class Me extends oe{constructor(e){super(),ne(this,e,Fe,ke,i,{text:2})}}function Le(e){let t,n,o,r,i;const s=e[5].default,a=l(s,e,e[4],null);return{c(){t=b("div"),n=b("div"),a&&a.c(),k(n,"class","wrapper svelte-1mca9gs"),k(t,"class","overlay svelte-1mca9gs")},m(s,c){m(s,t,c),v(t,n),a&&a.m(n,null),e[6](t),o=!0,r||(i=S(t,"mousedown",e[3]),r=!0)},p(e,t){a&&a.p&&(!o||16&t)&&d(a,s,e,e[4],o?f(s,e[4],t,null):p(e[4]),null)},i(e){o||(K(a,e),o=!0)},o(e){J(a,e),o=!1},d(n){n&&g(t),a&&a.d(n),e[6](null),r=!1,i()}}}function ze(e){let t,n,o=e[2]&&Le(e);return{c(){o&&o.c(),t=w()},m(e,r){o&&o.m(e,r),m(e,t,r),n=!0},p(e,[n]){e[2]?o?(o.p(e,n),4&n&&K(o,1)):(o=Le(e),o.c(),K(o,1),o.m(t.parentNode,t)):o&&(H(),J(o,1,1,(()=>{o=null})),X())},i(e){n||(K(o),n=!0)},o(e){J(o),n=!1},d(e){o&&o.d(e),e&&g(t)}}}function De(t,n,o){let r,i=e,a=()=>(i(),i=s(f,(e=>o(2,r=e))),f);t.$$.on_destroy.push((()=>i()));let c,{$$slots:l={},$$scope:u}=n,{state:f}=n;a();return t.$$set=e=>{"state"in e&&a(o(0,f=e.state)),"$$scope"in e&&o(4,u=e.$$scope)},[f,c,r,({target:e})=>{e===c&&h(f,r=!1,r)},u,l,function(e){C[e?"unshift":"push"]((()=>{c=e,o(1,c)}))}]}class Pe extends oe{constructor(e){super(),ne(this,e,De,ze,i,{state:0})}}let Ee;function _e(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function qe(e){let t,n,o,r,i,s,a,c,l=e[1]+"";return a=new Me({props:{text:e[1],$$slots:{default:[Ce]},$$scope:{ctx:e}}}),{c(){t=b("div"),t.textContent="Successfully published!",n=$(),o=b("div"),r=y(l),i=$(),s=b("div"),Q(a.$$.fragment),k(t,"class","heading svelte-14bizwa"),k(o,"class","link svelte-14bizwa"),k(s,"class","actions svelte-14bizwa")},m(e,l){m(e,t,l),m(e,n,l),m(e,o,l),v(o,r),m(e,i,l),m(e,s,l),ee(a,s,null),c=!0},p(e,t){const n={};4&t&&(n.$$scope={dirty:t,ctx:e}),a.$set(n)},i(e){c||(K(a.$$.fragment,e),c=!0)},o(e){J(a.$$.fragment,e),c=!1},d(e){e&&g(t),e&&g(n),e&&g(o),e&&g(i),e&&g(s),te(a)}}}function Ce(e){let t;return{c(){t=y("Copy link")},m(e,n){m(e,t,n)},d(e){e&&g(t)}}}function Te(t){let n;return{c(){n=b("div"),n.textContent="Publishing...",k(n,"class","heading svelte-14bizwa")},m(e,t){m(e,n,t)},p:e,i:e,o:e,d(e){e&&g(n)}}}function je(e){let t,n,o={ctx:e,current:null,token:null,hasCatch:!1,pending:Te,then:qe,catch:_e,value:1,blocks:[,,,]};return function(e,t){const n=t.token={};function o(e,o,r,i){if(t.token!==n)return;t.resolved=i;let s=t.ctx;void 0!==r&&(s=s.slice(),s[r]=i);const a=e&&(t.current=e)(s);let c=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==o&&e&&(H(),J(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),X())})):t.block.d(1),a.c(),K(a,1),a.m(t.mount(),t.anchor),c=!0),t.block=a,t.blocks&&(t.blocks[o]=a),c&&G()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=E();if(e.then((e=>{P(n),o(t.then,1,t.value,e),P(null)}),(e=>{if(P(n),o(t.catch,2,t.error,e),P(null),!t.hasCatch)throw e})),t.current!==t.pending)return o(t.pending,0),!0}else{if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}var r}(e[0](),o),{c(){t=b("div"),o.block.c(),k(t,"class","wrapper svelte-14bizwa")},m(e,r){m(e,t,r),o.block.m(t,o.anchor=null),o.mount=()=>t,o.anchor=null,n=!0},p(t,n){!function(e,t,n){const o=t.slice(),{resolved:r}=e;e.current===e.then&&(o[e.value]=r),e.current===e.catch&&(o[e.error]=r),e.block.p(o,n)}(o,e=t,n)},i(e){n||(K(o.block),n=!0)},o(e){for(let e=0;e<3;e+=1){J(o.blocks[e])}n=!1},d(e){e&&g(t),o.block.d(),o.token=null,o=null}}}function Be(e){let t,n;return t=new Pe({props:{state:fe,$$slots:{default:[je]},$$scope:{ctx:e}}}),{c(){Q(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,[n]){const o={};4&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(K(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Re(e){return[()=>(Ee?Promise.resolve(Ee):new Promise(((e,t)=>{const n=document.createElement("script");n.type="text/javascript",n.onload=e,n.onerror=t,n.src="https://cdn.jsdelivr.net/npm/ipfs-core@0.16.0/dist/index.min.js",document.head.appendChild(n)})).then((()=>window.IpfsCore.create({repo:String(Math.random()+Date.now()),init:{alogorithm:"ed25519"}}))).then((e=>(Ee=e,e)))).then((e=>e.add(he()))).then((e=>{fetch(`https://ipfs.io/ipfs/${e.cid}`).catch((()=>{}));const t=new URL(location);return t.hash=`#/ipfs:${e.cid}`,t.toString()})).catch((e=>console.error(e)))]}class Ue extends oe{constructor(e){super(),ne(this,e,Re,Be,i,{})}}function Ie(t){let n,o;return n=new be({props:{state:ue}}),{c(){Q(n.$$.fragment)},m(e,t){ee(n,e,t),o=!0},p:e,i(e){o||(K(n.$$.fragment,e),o=!0)},o(e){J(n.$$.fragment,e),o=!1},d(e){te(n,e)}}}class Ae extends oe{constructor(e){super(),ne(this,e,null,Ie,i,{})}}function Ne(t){let n,o,r;return{c(){n=b("input"),k(n,"type","number"),k(n,"id",t[0]),k(n,"max",t[1]),k(n,"min",t[2]),k(n,"step",t[3]),n.value=t[5],k(n,"class","svelte-io5ur8")},m(e,i){m(e,n,i),o||(r=S(n,"input",t[6]),o=!0)},p(e,[t]){1&t&&k(n,"id",e[0]),2&t&&k(n,"max",e[1]),4&t&&k(n,"min",e[2]),8&t&&k(n,"step",e[3]),32&t&&n.value!==e[5]&&(n.value=e[5])},i:e,o:e,d(e){e&&g(n),o=!1,r()}}}function Oe(t,n,o){let r,i=e,a=()=>(i(),i=s(d,(e=>o(5,r=e))),d);t.$$.on_destroy.push((()=>i()));let{id:c}=n,{max:l}=n,{min:u}=n,{step:f}=n,{state:d}=n;a();return t.$$set=e=>{"id"in e&&o(0,c=e.id),"max"in e&&o(1,l=e.max),"min"in e&&o(2,u=e.min),"step"in e&&o(3,f=e.step),"state"in e&&a(o(4,d=e.state))},[c,l,u,f,d,r,({target:{value:e}})=>{h(d,r=parseInt(e,10),r)}]}class Ge extends oe{constructor(e){super(),ne(this,e,Oe,Ne,i,{id:0,max:1,min:2,step:3,state:4})}}function Ve(t){let n,o,r;return{c(){n=b("input"),k(n,"type","range"),k(n,"id",t[0]),k(n,"max",t[1]),k(n,"min",t[2]),k(n,"step",t[3]),n.value=t[5],k(n,"class","svelte-1h3mesz")},m(e,i){m(e,n,i),o||(r=S(n,"input",t[6]),o=!0)},p(e,[t]){1&t&&k(n,"id",e[0]),2&t&&k(n,"max",e[1]),4&t&&k(n,"min",e[2]),8&t&&k(n,"step",e[3]),32&t&&(n.value=e[5])},i:e,o:e,d(e){e&&g(n),o=!1,r()}}}function We(t,n,o){let r,i=e,a=()=>(i(),i=s(d,(e=>o(5,r=e))),d);t.$$.on_destroy.push((()=>i()));let{id:c}=n,{max:l}=n,{min:u}=n,{step:f}=n,{state:d}=n;a();return t.$$set=e=>{"id"in e&&o(0,c=e.id),"max"in e&&o(1,l=e.max),"min"in e&&o(2,u=e.min),"step"in e&&o(3,f=e.step),"state"in e&&a(o(4,d=e.state))},[c,l,u,f,d,r,({target:{value:e}})=>{h(d,r=parseFloat(e),r)}]}class Ye extends oe{constructor(e){super(),ne(this,e,We,Ve,i,{id:0,max:1,min:2,step:3,state:4})}}function He(e,t,n){const o=e.slice();return o[2]=t[n].id,o[5]=t[n].name,o}function Xe(e){let t,n,o,r=e[5]+"";return{c(){t=b("option"),n=y(r),t.__value=o=e[2],t.value=t.__value},m(e,o){m(e,t,o),v(t,n)},p(e,i){1&i&&r!==(r=e[5]+"")&&F(n,r),1&i&&o!==(o=e[2])&&(t.__value=o,t.value=t.__value)},d(e){e&&g(t)}}}function Ke(t){let n,o,r,i=t[0],s=[];for(let e=0;e<i.length;e+=1)s[e]=Xe(He(t,i,e));return{c(){n=b("select");for(let e=0;e<s.length;e+=1)s[e].c();k(n,"id",t[2]),k(n,"class","svelte-146trro"),void 0===t[3]&&A((()=>t[4].call(n)))},m(e,i){m(e,n,i);for(let e=0;e<s.length;e+=1)s[e].m(n,null);L(n,t[3]),o||(r=S(n,"change",t[4]),o=!0)},p(e,[t]){if(1&t){let o;for(i=e[0],o=0;o<i.length;o+=1){const r=He(e,i,o);s[o]?s[o].p(r,t):(s[o]=Xe(r),s[o].c(),s[o].m(n,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}4&t&&k(n,"id",e[2]),9&t&&L(n,e[3])},i:e,o:e,d(e){e&&g(n),x(s,e),o=!1,r()}}}function Je(t,n,o){let r,i=e,a=()=>(i(),i=s(u,(e=>o(3,r=e))),u);t.$$.on_destroy.push((()=>i()));let{id:c}=n,{options:l}=n,{state:u}=n;return a(),t.$$set=e=>{"id"in e&&o(2,c=e.id),"options"in e&&o(0,l=e.options),"state"in e&&a(o(1,u=e.state))},[l,u,c,r,function(){r=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),u.set(r),o(0,l)}]}class Ze extends oe{constructor(e){super(),ne(this,e,Je,Ke,i,{id:2,options:0,state:1})}}function Qe(e,t,n){const o=e.slice();return o[6]=t[n].id,o[7]=t[n].name,o}function et(e,t,n){const o=e.slice();return o[7]=t[n].name,o[10]=t[n].items,o}function tt(e,t,n){const o=e.slice();return o[13]=t[n],o}function nt(t){let n,o,r=t[13]+"";return{c(){n=b("div"),o=y(r)},m(e,t){m(e,n,t),v(n,o)},p:e,d(e){e&&g(n)}}}function ot(e){let t,n,o,r,i,s,a=e[7]+"",c=e[10],l=[];for(let t=0;t<c.length;t+=1)l[t]=nt(tt(e,c,t));return{c(){t=b("div"),n=b("div"),o=y(a),r=$(),i=b("div");for(let e=0;e<l.length;e+=1)l[e].c();s=$(),k(n,"class","svelte-13z9b40"),k(i,"class","svelte-13z9b40"),k(t,"class","svelte-13z9b40")},m(e,a){m(e,t,a),v(t,n),v(n,o),v(t,r),v(t,i);for(let e=0;e<l.length;e+=1)l[e].m(i,null);v(t,s)},p(e,t){if(32&t){let n;for(c=e[10],n=0;n<c.length;n+=1){const o=tt(e,c,n);l[n]?l[n].p(o,t):(l[n]=nt(o),l[n].c(),l[n].m(i,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=c.length}},d(e){e&&g(t),x(l,e)}}}function rt(t){let n,o,r,i,s,a,c,l=t[6]+"",u=t[7]+"";return{c(){n=b("div"),o=b("div"),r=y(l),i=$(),s=b("div"),a=y(u),c=$(),k(o,"class","svelte-13z9b40"),k(s,"class","svelte-13z9b40"),k(n,"class","svelte-13z9b40")},m(e,t){m(e,n,t),v(n,o),v(o,r),v(n,i),v(n,s),v(s,a),v(n,c)},p:e,d(e){e&&g(n)}}}function it(e){let t,n,o,r,i,s,a,c,l,u,f,d,p,h,y,w,S,F,M,L,z,D,P,E;i=new Ye({props:{id:"resolution",state:e[2],step:.2,min:.2,max:1}}),u=new Ze({props:{id:"mode",options:e[4],state:e[1]}}),y=new Ge({props:{id:"iterations",state:e[0],step:100,min:100,max:1e3}});let _=e[5],q=[];for(let t=0;t<_.length;t+=1)q[t]=ot(et(e,_,t));let C=e[3],T=[];for(let t=0;t<C.length;t+=1)T[t]=rt(Qe(e,C,t));return{c(){t=b("div"),n=b("div"),o=b("label"),o.textContent="Resolution:",r=$(),Q(i.$$.fragment),s=$(),a=b("div"),c=b("label"),c.textContent="Mode:",l=$(),Q(u.$$.fragment),f=$(),d=b("div"),p=b("label"),p.textContent="Max iterations:",h=$(),Q(y.$$.fragment),w=$(),S=b("div"),S.textContent="Reference",F=$(),M=b("div");for(let e=0;e<q.length;e+=1)q[e].c();L=$(),z=b("div"),z.textContent="Controls",D=$(),P=b("div");for(let e=0;e<T.length;e+=1)T[e].c();k(o,"for","resolution"),k(o,"class","svelte-13z9b40"),k(n,"class","input svelte-13z9b40"),k(c,"for","mode"),k(c,"class","svelte-13z9b40"),k(a,"class","input svelte-13z9b40"),k(p,"for","iterations"),k(p,"class","svelte-13z9b40"),k(d,"class","input svelte-13z9b40"),k(S,"class","heading svelte-13z9b40"),k(M,"class","reference svelte-13z9b40"),k(z,"class","heading svelte-13z9b40"),k(P,"class","controls svelte-13z9b40"),k(t,"class","wrapper svelte-13z9b40")},m(e,g){m(e,t,g),v(t,n),v(n,o),v(n,r),ee(i,n,null),v(t,s),v(t,a),v(a,c),v(a,l),ee(u,a,null),v(t,f),v(t,d),v(d,p),v(d,h),ee(y,d,null),v(t,w),v(t,S),v(t,F),v(t,M);for(let e=0;e<q.length;e+=1)q[e].m(M,null);v(t,L),v(t,z),v(t,D),v(t,P);for(let e=0;e<T.length;e+=1)T[e].m(P,null);E=!0},p(e,[t]){if(32&t){let n;for(_=e[5],n=0;n<_.length;n+=1){const o=et(e,_,n);q[n]?q[n].p(o,t):(q[n]=ot(o),q[n].c(),q[n].m(M,null))}for(;n<q.length;n+=1)q[n].d(1);q.length=_.length}if(8&t){let n;for(C=e[3],n=0;n<C.length;n+=1){const o=Qe(e,C,n);T[n]?T[n].p(o,t):(T[n]=rt(o),T[n].c(),T[n].m(P,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=C.length}},i(e){E||(K(i.$$.fragment,e),K(u.$$.fragment,e),K(y.$$.fragment,e),E=!0)},o(e){J(i.$$.fragment,e),J(u.$$.fragment,e),J(y.$$.fragment,e),E=!1},d(e){e&&g(t),te(i),te(u),te(y),x(q,e),x(T,e)}}}function st(e){const{iterations:t,mode:n,resolution:o}=de;return[t,n,o,[{id:"W",name:"Move forwards"},{id:"A",name:"Move leftwards"},{id:"S",name:"Move backwards"},{id:"D",name:"Move rightwards"},{id:"Q",name:"Move downwards"},{id:"E",name:"Move upwards"},{id:"R",name:"Reset camera"},{id:"Shift",name:"Double movement speed"},{id:"Wheel",name:"Set movement speed"}],[{id:"raymarching",name:"Raymarching (better performance)"},{id:"conetracing",name:"Conetracing (better antialiasing)"}],[{name:"Color",items:["fn hsl2Rgb(hsl : vec3<f32>) -> vec3<f32>"]},{name:"Light",items:["struct Light { position : vec3<f32>, diffuse : vec3<f32>, specular : vec3<f32> }","fn getAttenuation(dist : f32, constant : f32, linear : f32, quadratic : f32) -> f32","fn getDirectLight(light : Light, normal : vec3<f32>, position : vec3<f32>, shininess : f32) -> vec3<f32>"]},{name:"Noise",items:["fn SimplexNoise(v : vec3<f32>) -> f32"]},{name:"Rotation",items:["const PI : f32","fn rotateX(radians : f32) -> mat3x3<f32>","fn rotateY(radians : f32) -> mat3x3<f32>","fn rotateZ(radians : f32) -> mat3x3<f32>","fn spherical(phi : f32, theta : f32, radius : f32) -> vec3<f32>"]},{name:"SDF",items:["struct SDF { color : vec3<f32>, distance : f32 }","fn opUnion(a : SDF, b : SDF) -> SDF","fn opSubstraction(a : SDF, b : SDF) -> SDF","fn opSmoothUnion(a : SDF, b : SDF, k : f32) -> SDF","fn opSmoothSubstraction(a : SDF, b : SDF, k : f32) -> SDF","fn sdBox(p : vec3<f32>, r : vec3<f32>) -> f32","fn sdCapsule(p : vec3<f32>, r : vec2<f32>) -> f32","fn sdEllipsoid(p : vec3<f32>, r : vec3<f32>) -> f32","fn sdPlane(p : vec3<f32>, n : vec3<f32>, h : f32) -> f32","fn sdSphere(p : vec3<f32>, r : f32) -> f32","fn sdTorus(p : vec3<f32>, r : vec2<f32>) -> f32"]},{name:"Uniforms",items:["struct Camera {","inverseMatrix : mat4x4<f32>,","position : vec3<f32>,","direction : vec3<f32>,","cone : f32,","near : f32,","far : f32,","}","var<uniform> camera : Camera;","var<uniform> time : f32;"]}]]}class at extends oe{constructor(e){super(),ne(this,e,st,it,i,{})}}const ct=e=>({}),lt=e=>({}),ut=e=>({}),ft=e=>({});function dt(e){let t,n,o,r;const i=e[1].toggle,s=l(i,e,e[0],ft),a=e[1].options,c=l(a,e,e[0],lt);return{c(){t=b("div"),s&&s.c(),n=$(),o=b("div"),c&&c.c(),k(o,"class","options svelte-7xzgh1"),k(t,"class","dropdown svelte-7xzgh1")},m(e,i){m(e,t,i),s&&s.m(t,null),v(t,n),v(t,o),c&&c.m(o,null),r=!0},p(e,[t]){s&&s.p&&(!r||1&t)&&d(s,i,e,e[0],r?f(i,e[0],t,ut):p(e[0]),ft),c&&c.p&&(!r||1&t)&&d(c,a,e,e[0],r?f(a,e[0],t,ct):p(e[0]),lt)},i(e){r||(K(s,e),K(c,e),r=!0)},o(e){J(s,e),J(c,e),r=!1},d(e){e&&g(t),s&&s.d(e),c&&c.d(e)}}}function pt(e,t,n){let{$$slots:o={},$$scope:r}=t;return e.$$set=e=>{"$$scope"in e&&n(0,r=e.$$scope)},[r,o]}class ht extends oe{constructor(e){super(),ne(this,e,pt,dt,i,{})}}function vt(e){let t,n;return t=new ht({props:{$$slots:{options:[xt],toggle:[gt]},$$scope:{ctx:e}}}),{c(){Q(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};32768&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(K(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function mt(t){let n;return{c(){n=b("div"),n.textContent="Fetching...",k(n,"class","fetching svelte-tysl6x")},m(e,t){m(e,n,t)},p:e,i:e,o:e,d(e){e&&g(n)}}}function gt(t){let n;return{c(){n=b("div"),n.innerHTML='<div class="arrow svelte-tysl6x"></div> \n      <div class="label svelte-tysl6x">File</div>',k(n,"class","toggle svelte-tysl6x"),k(n,"slot","toggle")},m(e,t){m(e,n,t)},p:e,d(e){e&&g(n)}}}function xt(t){let n,r,i,s,a,c,l;return{c(){n=b("div"),n.textContent="Import",r=$(),i=b("div"),i.textContent="Export",s=$(),a=b("div"),a.textContent="Publish",k(n,"class","action svelte-tysl6x"),k(i,"class","action svelte-tysl6x"),k(a,"class","action svelte-tysl6x")},m(e,o){m(e,n,o),m(e,r,o),m(e,i,o),m(e,s,o),m(e,a,o),c||(l=[S(n,"click",t[4]),S(i,"click",t[3]),S(a,"click",t[7])],c=!0)},p:e,d(e){e&&g(n),e&&g(r),e&&g(i),e&&g(s),e&&g(a),c=!1,o(l)}}}function bt(e){let t,n,r,i,s,a,c,l,u,f,d;const p=[mt,vt],h=[];function x(e,t){return e[2]?0:1}return a=x(e),c=h[a]=p[a](e),{c(){t=b("div"),n=b("input"),r=$(),i=b("a"),s=$(),c.c(),l=w(),k(n,"type","file"),k(n,"accept","application/json"),k(t,"class","helpers svelte-tysl6x")},m(o,c){m(o,t,c),v(t,n),e[9](n),v(t,r),v(t,i),e[10](i),m(o,s,c),h[a].m(o,c),m(o,l,c),u=!0,f||(d=[S(window,"dragenter",e[6]),S(window,"dragover",e[6]),S(window,"drop",e[8]),S(window,"hashchange",e[5]),S(n,"change",e[8])],f=!0)},p(e,[t]){let n=a;a=x(e),a===n?h[a].p(e,t):(H(),J(h[n],1,1,(()=>{h[n]=null})),X(),c=h[a],c?c.p(e,t):(c=h[a]=p[a](e),c.c()),K(c,1),c.m(l.parentNode,l))},i(e){u||(K(c),u=!0)},o(e){J(c),u=!1},d(n){n&&g(t),e[9](null),e[10](null),n&&g(s),h[a].d(n),n&&g(l),f=!1,o(d)}}}function yt(e,t,n){let o,r,i;c(e,fe,(e=>n(13,o=e)));let s=!1;const a=e=>{if(1!==e.version)throw new Error("version");ce.editor=null,ce.source.set(e.effect),ue.editor=null,ue.source.set(e.scene),de.iterations.set(e.iterations),de.mode.set(e.mode),de.resolution.set(e.resolution),de.input.reset()},l=()=>{const[e,t]=location.hash.slice(2).split("/")[0].split(":");"ipfs"===e&&t&&(h(fe,o=!1,o),n(2,s=!0),fetch(`https://ipfs.io/ipfs/${t}`).then((e=>e.json())).then(a).catch((e=>console.error(e))).finally((()=>{n(2,s=!1)})))};return _(l),[r,i,s,()=>{const{content:e,path:t}=he();n(1,i.download=t,i),n(1,i.href=URL.createObjectURL(e),i),i.click()},()=>r.click(),l,e=>e.preventDefault(),()=>{h(fe,o=!0,o)},e=>{e.preventDefault();const[t]=e.dataTransfer?e.dataTransfer.files:e.target.files;if(!t)return;const o=new FileReader;o.addEventListener("load",(()=>{n(0,r.value=null,r),a(JSON.parse(o.result))}),!1),o.readAsText(t)},function(e){C[e?"unshift":"push"]((()=>{r=e,n(0,r)}))},function(e){C[e?"unshift":"push"]((()=>{i=e,n(1,i)}))}]}class $t extends oe{constructor(e){super(),ne(this,e,yt,bt,i,{})}}function wt(e,t,n){const o=e.slice();return o[7]=t[n],o[9]=n,o}function St(e,t,n){const o=e.slice();return o[7]=t[n],o[9]=n,o}function kt(e,t,n){const o=e.slice();return o[11]=t[n].id,o[12]=t[n].name,o}function Ft(e){let t,n,o,r,i,s=e[12]+"";return{c(){t=b("div"),n=y(s),o=$(),k(t,"class","view svelte-7njirj"),z(t,"enabled",e[0]===e[11])},m(s,a){m(s,t,a),v(t,n),v(t,o),r||(i=S(t,"click",e[4](e[11])),r=!0)},p(n,o){e=n,3&o&&z(t,"enabled",e[0]===e[11])},d(e){e&&g(t),r=!1,i()}}}function Mt(e){let t,n;return t=new ht({props:{$$slots:{options:[_t],toggle:[Lt]},$$scope:{ctx:e}}}),{c(){Q(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};32769&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(K(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Lt(t){let n;return{c(){n=b("div"),n.innerHTML='<div class="label svelte-7njirj">Examples</div> \n          <div class="arrow svelte-7njirj"></div>',k(n,"class","toggle svelte-7njirj"),k(n,"slot","toggle")},m(e,t){m(e,n,t)},p:e,d(e){e&&g(n)}}}function zt(e){let t,n=ae,o=[];for(let t=0;t<n.length;t+=1)o[t]=Pt(wt(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=w()},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);m(e,t,n)},p(e,r){if(4&r){let i;for(n=ae,i=0;i<n.length;i+=1){const s=wt(e,n,i);o[i]?o[i].p(s,r):(o[i]=Pt(s),o[i].c(),o[i].m(t.parentNode,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(e){x(o,e),e&&g(t)}}}function Dt(e){let t,n=le,o=[];for(let t=0;t<n.length;t+=1)o[t]=Et(St(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=w()},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);m(e,t,n)},p(e,r){if(8&r){let i;for(n=le,i=0;i<n.length;i+=1){const s=St(e,n,i);o[i]?o[i].p(s,r):(o[i]=Et(s),o[i].c(),o[i].m(t.parentNode,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(e){x(o,e),e&&g(t)}}}function Pt(e){let t,n,o,r,i,s,a=e[9]+1+"";return{c(){t=b("div"),n=y("Effect "),o=y(a),r=$(),k(t,"class","action svelte-7njirj")},m(a,c){m(a,t,c),v(t,n),v(t,o),v(t,r),i||(s=S(t,"click",e[2](e[7])),i=!0)},p(t,n){e=t},d(e){e&&g(t),i=!1,s()}}}function Et(e){let t,n,o,r,i,s,a=e[9]+1+"";return{c(){t=b("div"),n=y("Scene "),o=y(a),r=$(),k(t,"class","action svelte-7njirj")},m(a,c){m(a,t,c),v(t,n),v(t,o),v(t,r),i||(s=S(t,"click",e[3](e[7])),i=!0)},p(t,n){e=t},d(e){e&&g(t),i=!1,s()}}}function _t(e){let t;function n(e,t){return"scene"===e[0]?Dt:"effect"===e[0]?zt:void 0}let o=n(e),r=o&&o(e);return{c(){r&&r.c(),t=w()},m(e,n){r&&r.m(e,n),m(e,t,n)},p(e,i){o===(o=n(e))&&r?r.p(e,i):(r&&r.d(1),r=o&&o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r&&r.d(e),e&&g(t)}}}function qt(e){let t,n,o,r,i,s,a;o=new $t({});let c=e[1],l=[];for(let t=0;t<c.length;t+=1)l[t]=Ft(kt(e,c,t));let u="settings"!==e[0]&&Mt(e);return{c(){t=b("div"),n=b("div"),Q(o.$$.fragment),r=$();for(let e=0;e<l.length;e+=1)l[e].c();i=$(),s=b("div"),u&&u.c(),k(n,"class","svelte-7njirj"),k(s,"class","svelte-7njirj"),k(t,"class","toolbar svelte-7njirj")},m(e,c){m(e,t,c),v(t,n),ee(o,n,null),v(n,r);for(let e=0;e<l.length;e+=1)l[e].m(n,null);v(t,i),v(t,s),u&&u.m(s,null),a=!0},p(e,[t]){if(19&t){let o;for(c=e[1],o=0;o<c.length;o+=1){const r=kt(e,c,o);l[o]?l[o].p(r,t):(l[o]=Ft(r),l[o].c(),l[o].m(n,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=c.length}"settings"!==e[0]?u?(u.p(e,t),1&t&&K(u,1)):(u=Mt(e),u.c(),K(u,1),u.m(s,null)):u&&(H(),J(u,1,1,(()=>{u=null})),X())},i(e){a||(K(o.$$.fragment,e),K(u),a=!0)},o(e){J(o.$$.fragment,e),J(u),a=!1},d(e){e&&g(t),te(o),x(l,e),u&&u.d()}}}function Ct(e,t,n){let o;c(e,pe,(e=>n(0,o=e)));return[o,[{id:"scene",name:"Scene"},{id:"effect",name:"Effect"},{id:"settings",name:"Settings"}],e=>()=>{ce.editor=null,ce.source.set(e)},e=>()=>{ue.editor=null,ue.source.set(e),de.input.reset()},e=>()=>{h(pe,o=e,o)}]}class Tt extends oe{constructor(e){super(),ne(this,e,Ct,qt,i,{})}}var jt=1e-6,Bt="undefined"!=typeof Float32Array?Float32Array:Array,Rt=Math.PI/180;function Ut(e){return e*Rt}function It(){var e=new Bt(16);return Bt!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var At=function(e,t,n,o,r){var i,s=1/Math.tan(t/2);return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(i=1/(o-r),e[10]=(r+o)*i,e[14]=2*r*o*i):(e[10]=-1,e[14]=-2*o),e};function Nt(){var e=new Bt(3);return Bt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ot(e,t,n){var o=new Bt(3);return o[0]=e,o[1]=t,o[2]=n,o}function Gt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Vt(e,t,n,o){return e[0]=t,e[1]=n,e[2]=o,e}function Wt(e,t,n,o){return e[0]=t[0]+n[0]*o,e[1]=t[1]+n[1]*o,e[2]=t[2]+n[2]*o,e}function Yt(e,t){var n=t[0],o=t[1],r=t[2],i=n*n+o*o+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function Ht(e){return e[0]=0,e[1]=0,e[2]=0,e}var Xt=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e};function Kt(){var e=new Bt(2);return Bt!=Float32Array&&(e[0]=0,e[1]=0),e}function Jt(e,t){var n=new Bt(2);return n[0]=e,n[1]=t,n}function Zt(e,t){return e[0]=t[0],e[1]=t[1],e}function Qt(e,t,n){return e[0]=t,e[1]=n,e}Nt(),function(){var e=Kt()}();const en=Ot(0,1,0);class tn{constructor({device:e,aspect:t=1,fov:n=75,near:o=.1,far:r=1e4}){this.device=e,this.data=new Float32Array(26),this.buffer=e.createBuffer({size:this.data.byteLength+Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM}),this.aspect=t,this.fov=n,this.near=o,this.far=r,this.inverseMatrix=this.data.subarray(0,16),this.position=this.data.subarray(16,19),this.direction=this.data.subarray(20,23),this.cone=this.data.subarray(23,24),this.data[24]=o,this.data[25]=r,this.projectionMatrix=It(),this.viewMatrix=It(),this.target=Nt()}setSize(e,t){const{fov:n}=this;this.aspect=e/t,this.cone[0]=2*Math.tan(Ut(n)/2)/t,this.updateProjection()}updateProjection(){const{projectionMatrix:e,aspect:t,fov:n,near:o,far:r}=this;At(e,Ut(n),t,o,r),this.updateBuffer()}updateView(){const{viewMatrix:e,direction:t,position:n,target:o}=this;var r,i,s,a,c,l,u,f,d,p,h,v,m,g,x,b,y,$,w,S,k,F,M;Yt(t,Xt(t,o,n)),r=e,s=o,a=en,x=(i=n)[0],b=i[1],y=i[2],$=a[0],w=a[1],S=a[2],k=s[0],F=s[1],M=s[2],Math.abs(x-k)<jt&&Math.abs(b-F)<jt&&Math.abs(y-M)<jt?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(r):(h=x-k,v=b-F,m=y-M,c=w*(m*=g=1/Math.hypot(h,v,m))-S*(v*=g),l=S*(h*=g)-$*m,u=$*v-w*h,(g=Math.hypot(c,l,u))?(c*=g=1/g,l*=g,u*=g):(c=0,l=0,u=0),f=v*u-m*l,d=m*c-h*u,p=h*l-v*c,(g=Math.hypot(f,d,p))?(f*=g=1/g,d*=g,p*=g):(f=0,d=0,p=0),r[0]=c,r[1]=f,r[2]=h,r[3]=0,r[4]=l,r[5]=d,r[6]=v,r[7]=0,r[8]=u,r[9]=p,r[10]=m,r[11]=0,r[12]=-(c*x+l*b+u*y),r[13]=-(f*x+d*b+p*y),r[14]=-(h*x+v*b+m*y),r[15]=1),this.updateBuffer()}updateBuffer(){const{buffer:e,data:t,device:n,projectionMatrix:o,viewMatrix:r,inverseMatrix:i}=this;var s,a,c,l,u,f,d,p,h,v,m,g,x,b,y,$,w,S,k,F,M,L,z;!function(e,t){var n=t[0],o=t[1],r=t[2],i=t[3],s=t[4],a=t[5],c=t[6],l=t[7],u=t[8],f=t[9],d=t[10],p=t[11],h=t[12],v=t[13],m=t[14],g=t[15],x=n*a-o*s,b=n*c-r*s,y=n*l-i*s,$=o*c-r*a,w=o*l-i*a,S=r*l-i*c,k=u*v-f*h,F=u*m-d*h,M=u*g-p*h,L=f*m-d*v,z=f*g-p*v,D=d*g-p*m,P=x*D-b*z+y*L+$*M-w*F+S*k;P&&(P=1/P,e[0]=(a*D-c*z+l*L)*P,e[1]=(r*z-o*D-i*L)*P,e[2]=(v*S-m*w+g*$)*P,e[3]=(d*w-f*S-p*$)*P,e[4]=(c*M-s*D-l*F)*P,e[5]=(n*D-r*M+i*F)*P,e[6]=(m*y-h*S-g*b)*P,e[7]=(u*S-d*y+p*b)*P,e[8]=(s*z-a*M+l*k)*P,e[9]=(o*M-n*z-i*k)*P,e[10]=(h*w-v*y+g*x)*P,e[11]=(f*y-u*w-p*x)*P,e[12]=(a*F-s*L-c*k)*P,e[13]=(n*L-o*F+r*k)*P,e[14]=(v*b-h*$-m*x)*P,e[15]=(u*$-f*b+d*x)*P)}(i,(s=i,a=o,c=r,l=a[0],u=a[1],f=a[2],d=a[3],p=a[4],h=a[5],v=a[6],m=a[7],g=a[8],x=a[9],b=a[10],y=a[11],$=a[12],w=a[13],S=a[14],k=a[15],F=c[0],M=c[1],L=c[2],z=c[3],s[0]=F*l+M*p+L*g+z*$,s[1]=F*u+M*h+L*x+z*w,s[2]=F*f+M*v+L*b+z*S,s[3]=F*d+M*m+L*y+z*k,F=c[4],M=c[5],L=c[6],z=c[7],s[4]=F*l+M*p+L*g+z*$,s[5]=F*u+M*h+L*x+z*w,s[6]=F*f+M*v+L*b+z*S,s[7]=F*d+M*m+L*y+z*k,F=c[8],M=c[9],L=c[10],z=c[11],s[8]=F*l+M*p+L*g+z*$,s[9]=F*u+M*h+L*x+z*w,s[10]=F*f+M*v+L*b+z*S,s[11]=F*d+M*m+L*y+z*k,F=c[12],M=c[13],L=c[14],z=c[15],s[12]=F*l+M*p+L*g+z*$,s[13]=F*u+M*h+L*x+z*w,s[14]=F*f+M*v+L*b+z*S,s[15]=F*d+M*m+L*y+z*k,s)),n.queue.writeBuffer(e,0,t)}}tn.WGSL="\nstruct Camera {\n  inverseMatrix : mat4x4<f32>,\n  position : vec3<f32>,\n  direction : vec3<f32>,\n  cone : f32,\n  near : f32,\n  far : f32,\n}\n";const nn=Nt(),on=Kt(),rn=Nt(),sn=Nt(),an=Nt(),cn=Ot(0,1,0);class ln{constructor({camera:e,target:t}){var n,o;this.camera=e,this.target=t,this.isFullscreen=!1,this.isLocked=!1,this.gamepad=null,this.keyboard={buttons:{run:!1},movement:Nt()},this.pointer={buttons:{primary:!1},movement:Kt(),position:Kt()},this.buttons={primary:!1},this.forward=Nt(),this.look={state:Jt(.5*Math.PI,Math.PI),target:Jt(.5*Math.PI,Math.PI)},this.position={state:e.position,target:(n=e.position,o=new Bt(3),o[0]=n[0],o[1]=n[1],o[2]=n[2],o)},this.speed={state:4,target:4},this.updateBounds(),t.addEventListener("contextmenu",this.onContextMenu.bind(this),!1),window.addEventListener("gamepaddisconnected",this.onGamepadDisconnected.bind(this),!1),window.addEventListener("gamepadconnected",this.onGamepadConnected.bind(this),!1),window.addEventListener("keydown",this.onKeyDown.bind(this),!1),window.addEventListener("keyup",this.onKeyUp.bind(this),!1),t.addEventListener("mousedown",this.onMouseDown.bind(this),!1),window.addEventListener("mousemove",this.onMouseMove.bind(this),!1),window.addEventListener("mouseup",this.onMouseUp.bind(this),!1),window.addEventListener("wheel",this.onMouseWheel.bind(this),{passive:!1}),document.addEventListener("fullscreenchange",this.onFullscreen.bind(this),!1),document.addEventListener("pointerlockchange",this.onPointerLock.bind(this),!1)}enterFullscreen(){const{isFullscreen:e,target:t}=this;e||t.requestFullscreen()}exitFullscreen(){const{isFullscreen:e}=this;e&&document.exitFullscreen()}lock(){const{isLocked:e,target:t}=this;e||t.requestPointerLock()}unlock(){const{isLocked:e}=this;e&&document.exitPointerLock()}onContextMenu(e){e.preventDefault()}onGamepadDisconnected({gamepad:{index:e}}){const{gamepad:t}=this;t===e&&(this.gamepad=null)}onGamepadConnected({gamepad:{index:e}}){this.gamepad=e}onKeyDown({key:e,repeat:t}){const{isLocked:n,keyboard:o}=this;if(n&&!t)switch(e.toLowerCase()){case"w":o.movement[2]=1;break;case"s":o.movement[2]=-1;break;case"a":o.movement[0]=-1;break;case"d":o.movement[0]=1;break;case"q":o.movement[1]=-1;break;case"e":o.movement[1]=1;break;case"shift":o.buttons.run=!0;break;case"r":this.reset()}}onKeyUp({key:e}){const{isLocked:t,keyboard:n}=this;if(t)switch(e.toLowerCase()){case"w":n.movement[2]>0&&(n.movement[2]=0);break;case"s":n.movement[2]<0&&(n.movement[2]=0);break;case"a":n.movement[0]<0&&(n.movement[0]=0);break;case"d":n.movement[0]>0&&(n.movement[0]=0);break;case"q":n.movement[1]<0&&(n.movement[1]=0);break;case"e":n.movement[1]>0&&(n.movement[1]=0);break;case"shift":n.buttons.run=!1}}onMouseDown({button:e}){const{isFullscreen:t,isLocked:n,pointer:o}=this;if(!n)return this.lock(),void(t||this.enterFullscreen());o.buttons.primary=0===e||2===e}onMouseMove({clientX:e,clientY:t,movementX:n,movementY:o}){const{sensitivity:r}=ln,{bounds:i,isLocked:s,pointer:{movement:a,position:c}}=this;s&&(a[0]-=n*r.pointer,a[1]+=o*r.pointer,Qt(c,(e-i.x)/i.width*2-1,-(t-i.y)/i.height*2+1))}onMouseUp({button:e}){const{isLocked:t,pointer:n}=this;!t||0!==e&&2!==e||(n.buttons.primary=!1)}onMouseWheel(e){const{sensitivity:t,minSpeed:n,speedRange:o}=ln,{isLocked:r,speed:i}=this;if(e.ctrlKey&&e.preventDefault(),!r)return;const s=Math.min(Math.max((Math.log(i.target)-n)/o-e.deltaY*t.wheel,0),1);i.target=Math.exp(n+s*o)}onFullscreen(){this.isFullscreen=!!document.fullscreenElement}onPointerLock(){const{buttons:e,keyboard:t,pointer:n}=this;this.isLocked=!!document.pointerLockElement,this.isLocked||(e.primary=!1,Vt(t.movement,0,0,0),t.buttons.run=!1,n.buttons.primary=!1)}update(e){const{minPhi:t,maxPhi:n,sensitivity:o}=ln,{isLocked:r,buttons:i,camera:s,forward:a,gamepad:c,keyboard:l,pointer:u,look:f,position:d,speed:p}=this;let h=!1;if(r){if(h=l.buttons.run,i.primary=u.buttons.primary,Gt(rn,l.movement),Zt(on,u.movement),null!==c){const{axes:e,buttons:t}=navigator.getGamepads()[c];(t[6]&&t[6].pressed||t[7]&&t[7].pressed)&&(i.primary=!0),Math.max(Math.abs(e[2]),Math.abs(e[3]))>.1&&Qt(on,-e[2]*o.gamepad,-e[3]*o.gamepad),Math.max(Math.abs(e[0]),Math.abs(e[1]))>.1&&Vt(rn,e[0],0,-e[1]),t[4]&&t[4].pressed?rn[1]=-1:t[5]&&t[5].pressed&&(rn[1]=1),t[10]&&t[10].pressed&&(h=!0)}f.target[0]=Math.min(Math.max(f.target[0]+on[1],t),n),f.target[1]+=on[0]}Qt(u.movement,0,0);{const t=1-Math.exp(-20*e);v=f.state,m=f.state,g=f.target,x=t,b=m[0],y=m[1],v[0]=b+x*(g[0]-b),v[1]=y+x*(g[1]-y),p.state=p.state*(1-t)+p.target*t}var v,m,g,x,b,y;if(Vt(a,Math.sin(f.state[0])*Math.sin(f.state[1]),Math.cos(f.state[0]),Math.sin(f.state[0])*Math.cos(f.state[1])),0!==rn[0]||0!==rn[1]||0!==rn[2]){Gt(sn,a),Yt(an,function(e,t,n){var o=t[0],r=t[1],i=t[2],s=n[0],a=n[1],c=n[2];return e[0]=r*c-i*a,e[1]=i*s-o*c,e[2]=o*a-r*s,e}(an,sn,cn)),Ht(nn),Wt(nn,nn,an,rn[0]),Wt(nn,nn,cn,rn[1]),Wt(nn,nn,sn,rn[2]),Ht(rn);const t=function(e){var t=e[0],n=e[1],o=e[2];return Math.hypot(t,n,o)}(nn);t>1&&function(e,t,n){e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n}(nn,nn,1/t),Wt(d.target,d.target,nn,e*p.state*(h?2:1))}{const t=1-Math.exp(-10*e);!function(e,t,n,o){var r=t[0],i=t[1],s=t[2];e[0]=r+o*(n[0]-r),e[1]=i+o*(n[1]-i),e[2]=s+o*(n[2]-s)}(d.state,d.state,d.target,t),function(e,t,n){e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2]}(s.target,s.position,a),s.updateView()}}updateBounds(){const{target:e}=this,t=e.getBoundingClientRect();this.bounds={width:Math.max(t.width,1),height:Math.max(t.height,1),x:t.x,y:t.y}}reset(){const{look:e,position:t}=this;Ht(t.target),Gt(t.state,t.target),Qt(e.target,.5*Math.PI,Math.PI),Zt(e.state,e.target)}}ln.sensitivity={gamepad:.03,pointer:.003,wheel:3e-4},ln.minPhi=.01,ln.maxPhi=Math.PI-.01,ln.minSpeed=Math.log(2),ln.maxSpeed=Math.log(64),ln.speedRange=ln.maxSpeed-ln.minSpeed;var un="struct FragmentOutput {\n  @location(0) color : vec4<f32>,\n  @location(1) data : vec4<f32>,\n  @location(2) position : vec4<f32>,\n}\n\nstruct VertexOutput {\n  @builtin(position) position : vec4<f32>,\n  @location(0) ray : vec3<f32>,\n}\n\n@group(0) @binding(0) var<uniform> camera : Camera;\n@group(0) @binding(1) var<uniform> time : f32;\n\nconst epsilon : f32 = 0.01;\n\nfn getNormal(pos : vec3<f32>, distance : f32) -> vec3<f32> {\n  const o : vec2<f32> = vec2<f32>(epsilon, 0);\n  return normalize(\n    distance - vec3<f32>(\n      getScene(pos - o.xyy).distance,\n      getScene(pos - o.yxy).distance,\n      getScene(pos - o.yyx).distance\n    )\n  );\n}\n\n@vertex\nfn vertex(@builtin(vertex_index) index : u32) -> VertexOutput {\n  // Hack to prevent BindGroup errors\n  // when user code doesn't use all of the uniforms\n  let t : f32 = time;\n\n  const quad = array<vec2<f32>, 6>(\n    vec2<f32>(-1, -1), vec2<f32>(1, -1), vec2<f32>(-1, 1),\n    vec2<f32>(-1, 1), vec2<f32>(1, -1), vec2<f32>(1, 1)\n  );\n  var out : VertexOutput;\n  out.position = vec4<f32>(quad[index], 0, 1);\n  let r : vec4<f32> = camera.inverseMatrix * vec4<f32>(quad[index], 0.5, 1);\n  out.ray = normalize((r.xyz / r.w) - camera.position);\n  return out;\n}\n\n@fragment\nfn conetracing(@location(0) ray : vec3<f32>) -> FragmentOutput {\n  var out : FragmentOutput;\n  var coverage : f32 = 1;\n  var depth : f32 = camera.near;\n  for (var i : u32 = 0; i < maxIterations && depth < camera.far; i++) {\n    let pos : vec3<f32> = camera.position + ray * depth;\n    let step : SDF = getScene(pos);\n    let cone : f32 = camera.cone * depth;\n    if (step.distance < cone) {\n      let alpha : f32 = smoothstep(cone, -cone, step.distance);\n      let normal : vec3<f32> = getNormal(pos, step.distance);\n      out.color += vec4<f32>(step.color * alpha * coverage, 0);\n      out.data += vec4<f32>(normal, depth) * alpha * coverage;\n      out.position += vec4<f32>(pos * alpha * coverage, 0);\n      coverage *= 1 - alpha;\n      if (coverage <= epsilon * 0.1) {\n        break;\n      }\n    }\n    depth += max(step.distance, epsilon);\n  }\n  if (coverage < 1) {\n    out.color = vec4<f32>(out.color.xyz, 1 - coverage);\n    out.data = vec4<f32>(normalize(out.data.xyz), out.data.w);\n    return out;\n  }\n  discard;\n}\n\n@fragment\nfn raymarching(@location(0) ray : vec3<f32>) -> FragmentOutput {\n  var out : FragmentOutput;\n  var depth : f32 = camera.near;\n  for (var i : u32 = 0; i < maxIterations && depth < camera.far; i++) {\n    let pos : vec3<f32> = camera.position + ray * depth;\n    let step : SDF = getScene(pos);\n    if (step.distance < epsilon) {\n      let normal : vec3<f32> = getNormal(pos, step.distance);\n      out.color = vec4<f32>(step.color, 1);\n      out.data = vec4<f32>(normal, depth);\n      out.position = vec4<f32>(pos, 1);\n      return out;\n    }\n    depth += max(step.distance, epsilon);\n  }\n  discard;\n}\n",fn="fn hsl2Rgb(hsl : vec3<f32>) -> vec3<f32> {\n  let h : f32 = clamp(hsl.x, 0, 1);\n  let s : f32 = clamp(hsl.y, 0, 1);\n  let l : f32 = clamp(hsl.z, 0, 1);\n  if (s == 0) {\n    return vec3<f32>(l, l, l);\n  }\n  var q : f32;\n  if (l < 0.5) {\n    q = l * (1 + s);\n  } else {\n    q = l + s - l * s;\n  }\n  let p = 2 * l - q;\n  return vec3<f32>(\n    hue2Rgb(p, q, h + 1 / 3.0),\n    hue2Rgb(p, q, h),\n    hue2Rgb(p, q, h - 1 / 3.0)\n  );\n}\n\nfn hue2Rgb(p : f32, q : f32, tt : f32) -> f32 {\n  var t : f32 = tt;\n  if (t < 0) { t += 1; }\n  if (t > 1) { t -= 1; }\n  if (t < 1 / 6.0) { return p + (q - p) * 6 * t; }\n  if (t < 1 / 2.0) { return q; }\n  if (t < 2 / 3.0) { return p + (q - p) * (2 / 3.0 - t) * 6; }\n  return p;\n}\n",dn="fn permute4(x : vec4<f32>) -> vec4<f32> { return ((x * 34. + 1.) * x) % vec4<f32>(289.); }\nfn taylorInvSqrt4(r : vec4<f32>) -> vec4<f32> { return 1.79284291400159 - 0.85373472095314 * r; }\n\nfn SimplexNoise(v : vec3<f32>) -> f32 {\n  let C = vec2<f32>(1. / 6., 1. / 3.);\n  let D = vec4<f32>(0., 0.5, 1., 2.);\n\n  var i: vec3<f32>  = floor(v + dot(v, C.yyy));\n  let x0 = v - i + dot(i, C.xxx);\n\n  let g = step(x0.yzx, x0.xyz);\n  let l = 1.0 - g;\n  let i1 = min(g.xyz, l.zxy);\n  let i2 = max(g.xyz, l.zxy);\n\n  let x1 = x0 - i1 + 1. * C.xxx;\n  let x2 = x0 - i2 + 2. * C.xxx;\n  let x3 = x0 - 1. + 3. * C.xxx;\n\n  i = i % vec3<f32>(289.);\n  let p = permute4(permute4(permute4(\n      i.z + vec4<f32>(0., i1.z, i2.z, 1. )) +\n      i.y + vec4<f32>(0., i1.y, i2.y, 1. )) +\n      i.x + vec4<f32>(0., i1.x, i2.x, 1. ));\n\n  var n_: f32 = 1. / 7.;\n  let ns = n_ * D.wyz - D.xzx;\n\n  let j = p - 49. * floor(p * ns.z * ns.z);\n\n  let x_ = floor(j * ns.z);\n  let y_ = floor(j - 7.0 * x_);\n\n  let x = x_ *ns.x + ns.yyyy;\n  let y = y_ *ns.x + ns.yyyy;\n  let h = 1.0 - abs(x) - abs(y);\n\n  let b0 = vec4<f32>( x.xy, y.xy );\n  let b1 = vec4<f32>( x.zw, y.zw );\n\n  let s0 = floor(b0)*2.0 + 1.0;\n  let s1 = floor(b1)*2.0 + 1.0;\n  let sh = -step(h, vec4<f32>(0.));\n\n  let a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  let a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  var p0: vec3<f32> = vec3<f32>(a0.xy, h.x);\n  var p1: vec3<f32> = vec3<f32>(a0.zw, h.y);\n  var p2: vec3<f32> = vec3<f32>(a1.xy, h.z);\n  var p3: vec3<f32> = vec3<f32>(a1.zw, h.w);\n\n  let norm = taylorInvSqrt4(vec4<f32>(dot(p0,p0), dot(p1,p1), dot(p2,p2), dot(p3,p3)));\n  p0 = p0 * norm.x;\n  p1 = p1 * norm.y;\n  p2 = p2 * norm.z;\n  p3 = p3 * norm.w;\n\n  var m: vec4<f32> = 0.6 - vec4<f32>(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3));\n  m = max(m, vec4<f32>(0.));\n  m = m * m;\n  return 42. * dot(m * m, vec4<f32>(dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3)));\n}\n",pn="const PI : f32 = 3.141592653589793;\n\nfn rotateX(radians : f32) -> mat3x3<f32> {\n  var c : f32 = cos(radians);\n  var s : f32 = sin(radians);\n  return mat3x3<f32>(\n    1, 0, 0,\n    0, c, s,\n    0, -s, c,\n  );\n}\n\nfn rotateY(radians : f32) -> mat3x3<f32> {\n  var c : f32 = cos(radians);\n  var s : f32 = sin(radians);\n  return mat3x3<f32>(\n    c, 0, -s,\n    0, 1, 0,\n    s, 0, c,\n  );\n}\n\nfn rotateZ(radians : f32) -> mat3x3<f32> {\n  var c : f32 = cos(radians);\n  var s : f32 = sin(radians);\n  return mat3x3<f32>(\n    c, s, 0,\n    -s, c, 0,\n    0, 0, 1,\n  );\n}\n\nfn spherical(phi : f32, theta : f32, radius : f32) -> vec3<f32> {\n  let sinPhiRadius = sin(phi) * radius;\n  return vec3<f32>(\n    sinPhiRadius * sin(theta),\n    cos(phi) * radius,\n    sinPhiRadius * cos(theta)\n  );\n}\n",hn="struct SDF {\n  color : vec3<f32>,\n  distance : f32,\n}\n\nfn opUnion(a : SDF, b : SDF) -> SDF {\n  if (a.distance < b.distance) {\n    return a;\n  }\n  return b;\n}\n\nfn opSubstraction(a : SDF, b : SDF) -> SDF {\n  if (a.distance > -b.distance) {\n    return a;\n  }\n  return SDF(b.color, -b.distance);\n}\n\nfn opSmoothUnion(a : SDF, b : SDF, k : f32) -> SDF {\n  let h : f32 = clamp(0.5 + 0.5 * (b.distance - a.distance) / k, 0, 1);\n  return SDF(\n    mix(b.color, a.color, h),\n    mix(b.distance, a.distance, h) - k*h*(1-h)\n  );\n}\n\nfn opSmoothSubstraction(a : SDF, b : SDF, k : f32) -> SDF {\n  let h : f32 = clamp(0.5 - 0.5 * (a.distance + b.distance) / k, 0, 1);\n  return SDF(\n    mix(a.color, b.color, h),\n    mix(a.distance, -b.distance, h) + k*h*(1-h)\n  );\n}\n\nfn sdBox(p : vec3<f32>, r : vec3<f32>) -> f32 {\n  let q : vec3<f32> = abs(p) - r;\n  return length(max(q, vec3<f32>(0))) + min(max(q.x, max(q.y, q.z)), 0);\n}\n\nfn sdCapsule(p : vec3<f32>, r : vec2<f32>) -> f32 {\n  let q : vec3<f32> = vec3<f32>(p.x, p.y - clamp(p.y, -r.y + r.x, r.y - r.x), p.z);\n  return length(q) - r.x;\n}\n\nfn sdEllipsoid(p : vec3<f32>, r : vec3<f32>) -> f32 {\n  let k0 : f32 = length(p / r);\n  let k1 : f32 = length(p / (r * r));\n  return k0 * (k0 - 1.0) / k1;\n}\n\nfn sdPlane(p : vec3<f32>, n : vec3<f32>, h : f32) -> f32 {\n  return dot(p,n) + h;\n}\n\nfn sdSphere(p : vec3<f32>, r : f32) -> f32 {\n  return length(p) - r;\n}\n\nfn sdTorus(p : vec3<f32>, r : vec2<f32>) -> f32 {\n  let q : vec2<f32> = vec2<f32>(length(p.xz) - r.x, p.y);\n  return length(q) - r.y;\n}\n";class vn{constructor(e){this.renderer=e}render(e){const{bindings:t,pipeline:n}=this;e.setPipeline(n),e.setBindGroup(0,t),e.draw(6)}setMaxIterations(e){this.maxIterations=e,this.updatePipeline()}setMode(e){this.mode=e,this.updatePipeline()}setScene(e){this.scene=e,this.updatePipeline()}updatePipeline(){const{renderer:{camera:e,device:t,time:n},maxIterations:o,mode:r,scene:i}=this;o&&r&&i&&(this.code=[`const maxIterations : u32 = ${o};`,e.constructor.WGSL,un,fn,dn,pn,hn,"// __SOURCE__",i].join("\n"),this.module=t.createShaderModule({code:this.code}),this.pipeline=t.createRenderPipeline({layout:"auto",vertex:{entryPoint:"vertex",module:this.module},fragment:{entryPoint:r,module:this.module,targets:[{format:"rgba32float"},{format:"rgba32float"},{format:"rgba32float"}]},primitive:{topology:"triangle-list"}}),this.bindings=t.createBindGroup({layout:this.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:e.buffer}},{binding:1,resource:{buffer:n}}]}))}}var mn="@group(0) @binding(0) var<uniform> camera : Camera;\n@group(0) @binding(1) var<uniform> time : f32;\n@group(1) @binding(0) var colorTexture : texture_2d<f32>;\n@group(1) @binding(1) var dataTexture : texture_2d<f32>;\n@group(1) @binding(2) var positionTexture : texture_2d<f32>;\n\nfn linearTosRGB(linear : vec3<f32>) -> vec3<f32> {\n  if (all(linear <= vec3<f32>(0.0031308))) {\n    return linear * 12.92;\n  }\n  return (pow(abs(linear), vec3<f32>(1.0/2.4)) * 1.055) - vec3<f32>(0.055);\n}\n\n@vertex\nfn vertex(@builtin(vertex_index) index : u32) -> @builtin(position) vec4<f32> {\n  // Hack to prevent BindGroup errors\n  // when user code doesn't use all of the uniforms\n  let t : f32 = time;\n\n  const quad = array<vec2<f32>, 6>(\n    vec2<f32>(-1, -1), vec2<f32>(1, -1), vec2<f32>(-1, 1),\n    vec2<f32>(-1, 1), vec2<f32>(1, -1), vec2<f32>(1, 1)\n  );\n  return vec4<f32>(quad[index], 0, 1);\n}\n\n@fragment\nfn fragment(@builtin(position) uv : vec4<f32>) -> @location(0) vec4<f32> {\n  return vec4<f32>(linearTosRGB(getEffect(vec2<i32>(floor(uv.xy)))), 1);\n}\n",gn="struct Light {\n  position : vec3<f32>,\n  diffuse : vec3<f32>,\n  specular : vec3<f32>,\n}\n\nfn getAttenuation(dist : f32, constant : f32, linear : f32, quadratic : f32) -> f32 {\n  return 1.0 / (constant + linear * dist + quadratic * (dist * dist));\n}\n\nfn getDirectLight(light : Light, normal : vec3<f32>, position : vec3<f32>, shininess : f32) -> vec3<f32> {\n  let lightDir = normalize(light.position - position);\n  let viewDir : vec3<f32> = normalize(camera.position - position);\n  let halfwayDir : vec3<f32> = normalize(lightDir + viewDir);\n\n  let diffuse : vec3<f32> = max(dot(lightDir, normal), 0) * light.diffuse;\n  let specular : vec3<f32> = pow(max(dot(normal, halfwayDir), 0), shininess) * light.specular;\n\n  return diffuse + specular;\n}\n";class xn{constructor({device:e,camera:t,format:n,time:o}){this.device=e,this.camera=t,this.format=n,this.time=o,this.descriptor={colorAttachments:[{clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]}}render(e,t){const{bindings:n,descriptor:o,pipeline:r,uniforms:i}=this;o.colorAttachments[0].view=t;const s=e.beginRenderPass(o);s.setPipeline(r),s.setBindGroup(0,i),s.setBindGroup(1,n),s.draw(6),s.end()}bindTextures(){const{device:e,pipeline:t,textures:n}=this;t&&n&&(this.bindings=e.createBindGroup({layout:t.getBindGroupLayout(1),entries:[{binding:0,resource:n.color},{binding:1,resource:n.data},{binding:2,resource:n.position}]}))}setEffect(e){const{device:t,camera:n,format:o,time:r}=this;this.code=[n.constructor.WGSL,mn,gn,pn,"// __SOURCE__",e].join("\n"),this.module=t.createShaderModule({code:this.code}),this.pipeline=t.createRenderPipeline({layout:"auto",vertex:{entryPoint:"vertex",module:this.module},fragment:{entryPoint:"fragment",module:this.module,targets:[{format:o}]},primitive:{topology:"triangle-list"}}),this.uniforms=t.createBindGroup({layout:this.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:n.buffer}},{binding:1,resource:{buffer:r}}]}),this.bindTextures()}setTextures({color:e,data:t,position:n}){this.textures={color:e,data:t,position:n},this.bindTextures()}}class bn{constructor({adapter:e,camera:t,device:n}){const o=navigator.gpu.getPreferredCanvasFormat(e);this.camera=t,this.device=n,this.canvas=document.createElement("canvas"),this.canvas.style.imageRendering="pixelated",this.context=this.canvas.getContext("webgpu"),this.descriptor={colorAttachments:[{clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"},{clearValue:{r:0,g:0,b:0,a:t.far},loadOp:"clear",storeOp:"store"},{clearValue:{r:0,g:0,b:0,a:0},loadOp:"clear",storeOp:"store"}]},this.time=n.createBuffer({size:Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM}),this.postprocessing=new xn({device:n,camera:t,format:o,time:this.time}),this.resolution=1,this.scene=[],this.textures=new Map,this.setSize(window.innerWidth,window.innerHeight),this.context.configure({alphaMode:"opaque",device:n,format:o})}render(e){const{context:t,descriptor:n,postprocessing:o,scene:r}=this,i=e.beginRenderPass(n);r.forEach((e=>e.render(i))),i.end(),o.render(e,t.getCurrentTexture().createView())}setSize(e,t,n=window.devicePixelRatio||1){const{camera:o,canvas:r,descriptor:i,postprocessing:s,resolution:a}=this,c=[Math.floor(e*n*a),Math.floor(t*n*a)];r.width=c[0],r.height=c[1],r.style.width=`${e}px`,r.style.height=`${t}px`,o.setSize(c[0],c[1]),this.updateTexture(i.colorAttachments[0],"rgba32float","color",c),this.updateTexture(i.colorAttachments[1],"rgba32float","data",c),this.updateTexture(i.colorAttachments[2],"rgba32float","position",c),s.setTextures({color:i.colorAttachments[0].view,data:i.colorAttachments[1].view,position:i.colorAttachments[2].view})}updateTexture(e,t,n,o){const{device:r,textures:i}=this,s=i.get(n);s&&s.destroy();const a=r.createTexture({format:t,size:o,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});e.view=a.createView(),i.set(n,a)}}function yn(t){let n;return{c(){n=b("div"),k(n,"class","viewport svelte-vo8in0")},m(e,o){m(e,n,o),t[1](n)},p:e,i:e,o:e,d(e){e&&g(n),t[1](null)}}}function $n(e,t,n){let o;return _((()=>{const{adapter:e,device:t}=de.gpu,n=new tn({device:t}),r=new ln({camera:n,target:o}),i=new bn({adapter:e,camera:n,device:t});o.appendChild(i.canvas);const s=new vn(i);i.scene.push(s);const a=new Float32Array([performance.now()/1e3]);document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&(a[0]=performance.now()/1e3)}),!1);let c=!1;const l=()=>{requestAnimationFrame(l);const e=performance.now()/1e3,n=Math.min(e-a[0],1);if(a[0]=e,c)return;r.update(n),t.queue.writeBuffer(i.time,0,a);const o=t.createCommandEncoder();i.render(o),t.queue.submit([o.finish()])},u=({code:e,module:t},n)=>{c=!1;const o=e.split("\n"),r=o.indexOf("// __SOURCE__")+1;t.compilationInfo().then((({messages:e})=>n.set(e.map((({length:e,lineNum:t,linePos:n,message:i,type:s})=>(c=!0,{line:o[t-1],lineNum:t-r,linePos:n,length:e,message:i,pointer:Array.from({length:n-1+e},((e,t)=>t>=n-1?"^":" ")).join(""),type:s}))))))};de.input=r;const f=[de.iterations.subscribe((e=>s.setMaxIterations(e))),de.mode.subscribe((e=>s.setMode(e))),de.resolution.subscribe((e=>{i.resolution=Math.pow(.5,Math.floor(6*(1-e))),i.setSize(r.bounds.width,r.bounds.height)})),ce.source.subscribe((e=>{i.postprocessing.setEffect(e),u(i.postprocessing,ce.errors)})),ue.source.subscribe((e=>{s.setScene(e),u(s,ue.errors)}))];return requestAnimationFrame(l),window.addEventListener("resize",(()=>{r.updateBounds(),i.setSize(r.bounds.width,r.bounds.height)}),!1),()=>{f.forEach((e=>e())),de.input=null}})),[o,function(e){C[e?"unshift":"push"]((()=>{o=e,n(0,o)}))}]}class wn extends oe{constructor(e){super(),ne(this,e,$n,yn,i,{})}}const{window:Sn}=Z;function kn(e){let t,n;return t=new at({}),{c(){Q(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},i(e){n||(K(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Fn(e){let t,n;return t=new Ae({}),{c(){Q(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},i(e){n||(K(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Mn(e){let t,n;return t=new $e({}),{c(){Q(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},i(e){n||(K(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Ln(e){let t,n,i,s,a,c,l,u,f,d,p,h,x,y,w;i=new Tt({});const F=[Mn,Fn,kn],L=[];function z(e,t){return"effect"===e[1]?0:"scene"===e[1]?1:"settings"===e[1]?2:-1}return~(a=z(e))&&(c=L[a]=F[a](e)),d=new wn({}),h=new Ue({}),{c(){t=b("div"),n=b("div"),Q(i.$$.fragment),s=$(),c&&c.c(),l=$(),u=b("div"),f=$(),Q(d.$$.fragment),p=$(),Q(h.$$.fragment),k(n,"class","ui svelte-efpout"),M(n,"width",e[0].state+"px"),k(u,"class","divider svelte-efpout"),k(t,"class","app svelte-efpout")},m(o,c){m(o,t,c),v(t,n),ee(i,n,null),v(n,s),~a&&L[a].m(n,null),v(t,l),v(t,u),v(t,f),ee(d,t,null),m(o,p,c),ee(h,o,c),x=!0,y||(w=[S(Sn,"mousemove",(function(){r(e[0].enabled&&e[3])&&(e[0].enabled&&e[3]).apply(this,arguments)})),S(Sn,"mouseup",(function(){r(e[0].enabled&&e[4])&&(e[0].enabled&&e[4]).apply(this,arguments)})),S(u,"mousedown",e[2])],y=!0)},p(t,[o]){let r=a;a=z(e=t),a!==r&&(c&&(H(),J(L[r],1,1,(()=>{L[r]=null})),X()),~a?(c=L[a],c||(c=L[a]=F[a](e),c.c()),K(c,1),c.m(n,null)):c=null),(!x||1&o)&&M(n,"width",e[0].state+"px")},i(e){x||(K(i.$$.fragment,e),K(c),K(d.$$.fragment,e),K(h.$$.fragment,e),x=!0)},o(e){J(i.$$.fragment,e),J(c),J(d.$$.fragment,e),J(h.$$.fragment,e),x=!1},d(e){e&&g(t),te(i),~a&&L[a].d(),te(d),e&&g(p),te(h,e),y=!1,o(w)}}}function zn(e,t,n){let o;c(e,pe,(e=>n(1,o=e)));const r={enabled:!1,initial:0,offset:0,state:512};return[r,o,({clientX:e})=>{n(0,r.enabled=!0,r),n(0,r.initial=r.state,r),n(0,r.offset=e,r)},({clientX:e})=>{n(0,r.state=Math.max(Math.floor(r.initial+e-r.offset),340),r),I().then((()=>window.dispatchEvent(new Event("resize"))))},()=>{n(0,r.enabled=!1,r)}]}class Dn extends oe{constructor(e){super(),ne(this,e,zn,Ln,i,{})}}function Pn(e){let t,n;return t=new Dn({}),{c(){Q(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},i(e){n||(K(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function En(t){let n;return{c(){n=b("div"),n.innerHTML='Sorry! You&#39;ll need to try this in a browser with WebGPU support like <a href="https://www.google.com/chrome" rel="noopener noreferrer" target="_blank" class="svelte-1bwkh19">Chrome</a>.',k(n,"class","support svelte-1bwkh19")},m(e,t){m(e,n,t)},i:e,o:e,d(e){e&&g(n)}}}function _n(t){let n;return{c(){n=b("div"),n.textContent="Loading...",k(n,"class","loading svelte-1bwkh19")},m(e,t){m(e,n,t)},i:e,o:e,d(e){e&&g(n)}}}function qn(e){let t,n,o,r,i,s,a;const c=[_n,En,Pn],l=[];function u(e,t){return e[1]?0:e[0]?1:2}return t=u(e),n=l[t]=c[t](e),{c(){n.c(),o=$(),r=b("div"),r.innerHTML='marcher - <a href="https://github.com/danielesteban/marcher" rel="noopener noreferrer" target="_blank" class="svelte-1bwkh19">view source</a><br/> \n  <a href="https://dani.gatunes.com" rel="noopener noreferrer" target="_blank" class="svelte-1bwkh19">dani@gatunes</a> © 2022',i=$(),s=b("a"),s.textContent="♥ Become a sponsor",k(r,"class","info svelte-1bwkh19"),k(s,"class","ribbon svelte-1bwkh19"),k(s,"href","https://github.com/sponsors/danielesteban"),k(s,"data-ribbon","♥ Become a sponsor"),k(s,"rel","noopener noreferrer"),k(s,"target","_blank")},m(e,n){l[t].m(e,n),m(e,o,n),m(e,r,n),m(e,i,n),m(e,s,n),a=!0},p(e,[r]){let i=t;t=u(e),t!==i&&(H(),J(l[i],1,1,(()=>{l[i]=null})),X(),n=l[t],n||(n=l[t]=c[t](e),n.c()),K(n,1),n.m(o.parentNode,o))},i(e){a||(K(n),a=!0)},o(e){J(n),a=!1},d(e){l[t].d(e),e&&g(o),e&&g(r),e&&g(i),e&&g(s)}}}function Cn(e,t,n){let o=!1,r=!0;return Promise.all([(async()=>{if(!navigator.gpu)throw new Error("WebGPU support");const e=await navigator.gpu.requestAdapter();if(!e)throw new Error("WebGPU adapter");const t=await e.requestDevice();return{adapter:e,device:t}})(),new Promise((e=>{require.config({paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.33.0/min/vs"}}),require(["vs/editor/editor.main"],e)}))]).then((([e])=>{de.gpu=e})).catch((e=>{console.error(e),n(0,o=!0)})).finally((()=>{n(1,r=!1)})),[o,r]}new class extends oe{constructor(e){super(),ne(this,e,Cn,qn,i,{})}}({target:document.body})}();
